---
layout: '@layouts/TechLayout.astro'
title: Deploy to Production
---

# Deploy to Production

<p class="lead">In this guide, you will learn how to deploy Aleph to production using Docker Compose. Follow this guide if you want to deploy a small to medium-scale Aleph instance that is accessible to other people.</p>

## System requirements

* 8GB (or more) of RAM. While Aleph can start with much less, we advise providing ample main memory for ideal performance.

* A domain name or IP address which can be used at the root via HTTPS (i.e. Aleph doesn't support running at a sub-path like `/aleph`).

* An internet connection to download and install Aleph.

* A working install of Docker Engine and Docker Compose. Please refer to the official [Docker documentation](https://docs.docker.com/engine/install/#server) for installation instructions for your operating system.

* An SMTP mail server or an account with an email service provider that supports SMTP to send outbound email.

## Configure your host system

Aleph uses [Elasticsearch](https://www.elastic.co/elasticsearch/) to store and search data. Elasticsearch maps search indices to memory. The default operating system limits are likely too low and need to be increased.

Run the following command to increase the operating system limits:

```sh
sysctl -w vm.max_map_count=262144
```

## Configure Aleph

To begin a production deployment, download a copy of Aleph’s `docker-compose.yml` file and configuration template:

```sh
curl -L https://raw.githubusercontent.com/alephdata/aleph/main/docker-compose.yml > docker-compose.yml
curl -L https://raw.githubusercontent.com/alephdata/aleph/main/aleph.env.tmpl > aleph.env.tmpl
```

Aleph can be configured using environment variables. By default, Aleph loads environment variables from a file named `aleph.env`. Run the following command to create a copy of the template that you can override:

```sh
cp aleph.env.tmpl aleph.env
```

### Aleph version

In `aleph.env` set the `ALEPH_TAG` configuration option to specify the Aleph version you want to deploy. If `ALEPH_TAG` is not set, the stable version specified in `docker-compose.yml` is deployed.

### Secret key

Next, you need to generate a random, secret key that Aleph uses for cryptographic signatures and encryption. Run the following command to generate a 24-character random string:

```sh
openssl rand -hex 24
```

Copy the generated string and paste it as the value for `ALEPH_SECRET_KEY`.

### User Interface

Set `ALEPH_UI_URL` to the URL where the user interface will be made available. For example, if you plan to use `example.org` as the domain name for your Aleph instance, set `ALEPH_UI_URL=https://example.org`. You can also configure the user interface to use a custom title, logo, and more. Refer to the the [configuration options reference](/devs-admins/reference/configuration-options#user-interface) for details.

### Email

Aleph needs to be able to send emails to users, for example to notify them of new search results for saved search queries. Configure an SMTP server using the [`ALEPH_MAIL_*` configuration options](/devs-admins/reference/configuration-options#email).

### Storage (optional)

By default, Aleph stores uploaded files on the local file system. However, Aleph also supports storing files using [AWS S3](https://aws.amazon.com/s3/) (or an S3-compatible service) or [Google Cloud Storage](https://cloud.google.com/storage/). Refer to ["How to configure a storage provider"](/devs-admins/how-to/operations/blob-storage) for instructions.

### Authentication (optional)

By default, Aleph allows userss to sign up and authenticate using password authentication. However, you can also delegate authentication to an OAuth/OIDC identify provider. Aleph supports Microsoft Azure, Google, Keycloak, AWS Cognito and others out of the box. Refer to ["How to configure OAuth"](/devs-admins/how-to/operations/oauth) for details.

### Other configuration options

Most configuration options use sensible defaults which means you do not need to adjust them unless you have specific requirements. You can find a list of all available configuration options in the [reference section](/devs-admins/reference/configuration-options) of the documentation.

## Start Aleph

Finally, run the following command to start Aleph in detached mode. This menas containers run in the background, so you can exit your shell session at any time without stopping the containers. By default, Docker tries to restart containers automatically when the crash.

If you run this command for the first time, Docker Compose downloads Docker images for all services before starting the containers. This may take a while.

```sh
docker compose up -d
```

After all services have started, run the following command to migrate Aleph’s database and create Elasticsearch indices. This command makes use of the `aleph` CLI that’s installed in the Aleph Docker image

```sh
docker compose run --rm shell aleph upgrade
```

While Aleph is running, it binds to port `8080` on the host machine. You can check that Aleph is running and accepts incoming connections using a curl request:

```sh
curl -i http://localhost:8080
```

## Create an admin user

You need an admin account in order to perform certain actions via the user interface. Run the following command (replacing the placeholder values) to create an admin account:

```sh
docker compose run --rm shell aleph createuser --name="Alice" --admin --password="123abc" user@example.org
```

## Expose ports to the internet

<Callout theme="danger">
  Be careful with the ports exposed from your Docker system on public ports. Docker is known to override some firewall rules so make sure you double-check that you're only exposing ports for the user interface. Ports for databases and Elasticsearch as well as the API service must never be directly exposed to the internet.
</Callout>

## HTTPS

WIP

## Stop Aleph

You can shut down Aleph using the following command:

```sh
docker compose down
```
